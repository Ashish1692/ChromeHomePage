<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Homepage</title>
    <style>
        :root {
            --bg-gradient-1: #667eea;
            --bg-gradient-2: #764ba2;
            --card-bg: #ffffff;
            --card-shadow: rgba(0, 0, 0, 0.1);
            --card-shadow-hover: rgba(0, 0, 0, 0.2);
            --text-primary: #333;
            --text-secondary: #555;
            --text-light: #ffffff;
            --border-color: #e1e1e1;
            --modal-bg: rgba(0, 0, 0, 0.5);
            --add-card-bg: rgba(255, 255, 255, 0.2);
            --add-card-border: rgba(255, 255, 255, 0.5);
        }

        [data-theme="dark"] {
            --bg-gradient-1: #1a1a2e;
            --bg-gradient-2: #16213e;
            --card-bg: #2d2d3a;
            --card-shadow: rgba(0, 0, 0, 0.3);
            --card-shadow-hover: rgba(0, 0, 0, 0.5);
            --text-primary: #e4e4e4;
            --text-secondary: #b8b8b8;
            --text-light: #ffffff;
            --border-color: #404050;
            --modal-bg: rgba(0, 0, 0, 0.7);
            --add-card-bg: rgba(255, 255, 255, 0.05);
            --add-card-border: rgba(255, 255, 255, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, var(--bg-gradient-1) 0%, var(--bg-gradient-2) 100%);
            min-height: 100vh;
            padding: 40px 20px;
            color: var(--text-primary);
            transition: background 0.3s ease;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
        }

        h1 {
            color: var(--text-light);
            font-weight: 300;
            font-size: 2.5rem;
        }

        .controls {
            display: flex;
            gap: 15px;
        }

        .theme-toggle {
            background: var(--card-bg);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px var(--card-shadow);
        }

        .theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px var(--card-shadow-hover);
        }

        .shortcuts-btn {
            background: var(--card-bg);
            border: none;
            padding: 0 20px;
            height: 50px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            color: var(--text-primary);
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px var(--card-shadow);
            font-weight: 500;
        }

        .shortcuts-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px var(--card-shadow-hover);
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .site-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 30px 20px;
            text-align: center;
            cursor: grab;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px var(--card-shadow);
            position: relative;
            text-decoration: none;
            color: inherit;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 140px;
        }

        .site-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px var(--card-shadow-hover);
        }

        .site-card.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }

        .site-card.drag-over {
            border: 2px dashed #667eea;
            transform: scale(1.05);
        }

        .site-icon {
            font-size: 2.5rem;
            margin-bottom: 12px;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .site-icon img {
            width: 48px;
            height: 48px;
            border-radius: 8px;
        }

        .site-name {
            font-size: 0.95rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .shortcut-number {
            position: absolute;
            top: 8px;
            left: 8px;
            background: rgba(102, 126, 234, 0.8);
            color: white;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .site-card:hover .shortcut-number {
            opacity: 1;
        }

        .card-actions {
            position: absolute;
            top: 8px;
            right: 8px;
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .site-card:hover .card-actions {
            opacity: 1;
        }

        .edit-btn,
        .delete-btn {
            background: #667eea;
            color: white;
            border: none;
            border-radius: 50%;
            width: 28px;
            height: 28px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            line-height: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .edit-btn:hover {
            background: #5568d3;
            transform: scale(1.1);
        }

        .delete-btn {
            background: #ff4757;
        }

        .delete-btn:hover {
            background: #ff3838;
            transform: scale(1.1);
        }

        .add-card {
            background: var(--add-card-bg);
            border: 2px dashed var(--add-card-border);
            color: var(--text-light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            cursor: pointer;
        }

        .add-card:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.8);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--modal-bg);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--card-bg);
            padding: 30px;
            border-radius: 12px;
            width: 90%;
            max-width: 450px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .modal-content h2 {
            margin-bottom: 20px;
            color: var(--text-primary);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s;
            background: var(--card-bg);
            color: var(--text-primary);
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .icon-type-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .icon-type-btn {
            flex: 1;
            padding: 8px;
            border: 2px solid var(--border-color);
            background: var(--card-bg);
            color: var(--text-secondary);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .icon-type-btn.active {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 25px;
        }

        .btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
        }

        .btn-secondary {
            background: var(--border-color);
            color: var(--text-secondary);
        }

        .btn-secondary:hover {
            background: #d1d1d1;
        }

        .shortcuts-modal .modal-content {
            max-width: 500px;
        }

        .shortcuts-list {
            list-style: none;
        }

        .shortcuts-list li {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .shortcuts-list li:last-child {
            border-bottom: none;
        }

        .shortcut-key {
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .shortcut-desc {
            color: var(--text-secondary);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }

            .header {
                flex-direction: column;
                gap: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>My Favorites</h1>
            <div class="controls">
                <button class="theme-toggle" id="themeToggle" title="Toggle Dark Mode (D)">üåô</button>
                <button class="shortcuts-btn" id="shortcutsBtn">‚å®Ô∏è Shortcuts</button>
            </div>
        </div>
        
        <div class="grid" id="sitesGrid">
            <!-- Sites will be dynamically added here -->
        </div>
    </div>

    <!-- Add/Edit Site Modal -->
    <div class="modal" id="siteModal">
        <div class="modal-content">
            <h2 id="modalTitle">Add New Website</h2>
            <form id="siteForm">
                <div class="form-group">
                    <label for="siteName">Name</label>
                    <input type="text" id="siteName" required placeholder="e.g., YouTube">
                </div>
                <div class="form-group">
                    <label for="siteUrl">URL</label>
                    <input type="url" id="siteUrl" required placeholder="https://youtube.com">
                </div>
                <div class="form-group">
                    <label>Icon Type</label>
                    <div class="icon-type-selector">
                        <button type="button" class="icon-type-btn active" data-type="favicon">Favicon</button>
                        <button type="button" class="icon-type-btn" data-type="emoji">Emoji</button>
                    </div>
                </div>
                <div class="form-group" id="emojiGroup" style="display: none;">
                    <label for="siteIcon">Emoji</label>
                    <input type="text" id="siteIcon" placeholder="üé•" maxlength="2">
                </div>
                <div class="btn-group">
                    <button type="button" class="btn btn-secondary" id="cancelBtn">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="submitBtn">Add</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Shortcuts Modal -->
    <div class="modal shortcuts-modal" id="shortcutsModal">
        <div class="modal-content">
            <h2>‚å®Ô∏è Keyboard Shortcuts</h2>
            <ul class="shortcuts-list">
                <li>
                    <span class="shortcut-desc">Add new website</span>
                    <span class="shortcut-key">A</span>
                </li>
                <li>
                    <span class="shortcut-desc">Toggle dark mode</span>
                    <span class="shortcut-key">D</span>
                </li>
                <li>
                    <span class="shortcut-desc">Close modal</span>
                    <span class="shortcut-key">ESC</span>
                </li>
                <li>
                    <span class="shortcut-desc">Open site 1-9</span>
                    <span class="shortcut-key">1-9</span>
                </li>
                <li>
                    <span class="shortcut-desc">View shortcuts</span>
                    <span class="shortcut-key">?</span>
                </li>
            </ul>
            <div class="btn-group">
                <button type="button" class="btn btn-primary" id="closeShortcutsBtn">Got it!</button>
            </div>
        </div>
    </div>

    <script>
        // Default websites
        const defaultSites = [
            { name: 'YouTube', url: 'https://youtube.com', iconType: 'favicon' },
            { name: 'GitHub', url: 'https://github.com', iconType: 'favicon' },
            { name: 'Gmail', url: 'https://gmail.com', iconType: 'favicon' },
            { name: 'Twitter', url: 'https://twitter.com', iconType: 'favicon' },
            { name: 'Reddit', url: 'https://reddit.com', iconType: 'favicon' },
            { name: 'Netflix', url: 'https://netflix.com', iconType: 'favicon' }
        ];

        // Load data from localStorage
        let sites = JSON.parse(localStorage.getItem('favoriteSites')) || defaultSites;
        let currentTheme = localStorage.getItem('theme') || 'light';
        let currentIconType = 'favicon';
        let editingIndex = null; // Track which site is being edited

        // Elements
        const sitesGrid = document.getElementById('sitesGrid');
        const siteModal = document.getElementById('siteModal');
        const shortcutsModal = document.getElementById('shortcutsModal');
        const siteForm = document.getElementById('siteForm');
        const modalTitle = document.getElementById('modalTitle');
        const submitBtn = document.getElementById('submitBtn');
        const themeToggle = document.getElementById('themeToggle');
        const shortcutsBtn = document.getElementById('shortcutsBtn');
        const cancelBtn = document.getElementById('cancelBtn');
        const closeShortcutsBtn = document.getElementById('closeShortcutsBtn');
        const iconTypeBtns = document.querySelectorAll('.icon-type-btn');
        const emojiGroup = document.getElementById('emojiGroup');

        // Drag and drop variables
        let draggedElement = null;
        let draggedIndex = null;

        // Initialize
        applyTheme(currentTheme);
        renderSites();

        // Functions
        function saveSites() {
            localStorage.setItem('favoriteSites', JSON.stringify(sites));
        }

        function getFaviconUrl(url) {
            try {
                const domain = new URL(url).hostname;
                return `https://www.google.com/s2/favicons?domain=${domain}&sz=128`;
            } catch {
                return '';
            }
        }

        function renderSites() {
            sitesGrid.innerHTML = '';
            
            sites.forEach((site, index) => {
                const card = document.createElement('a');
                card.className = 'site-card';
                card.href = site.url;
                card.draggable = true;
                card.dataset.index = index;

                const iconHtml = site.iconType === 'emoji' && site.icon
                    ? `<div class="site-icon">${site.icon}</div>`
                    : `<div class="site-icon"><img src="${getFaviconUrl(site.url)}" alt="${site.name}" onerror="this.style.display='none'"></div>`;

                const shortcutNum = index < 9 ? index + 1 : '';

                card.innerHTML = `
                    ${shortcutNum ? `<div class="shortcut-number">${shortcutNum}</div>` : ''}
                    <div class="card-actions">
                        <button class="edit-btn" onclick="editSite(event, ${index})" title="Edit">‚úèÔ∏è</button>
                        <button class="delete-btn" onclick="deleteSite(event, ${index})" title="Delete">√ó</button>
                    </div>
                    ${iconHtml}
                    <div class="site-name">${site.name}</div>
                `;

                // Drag events
                card.addEventListener('dragstart', handleDragStart);
                card.addEventListener('dragend', handleDragEnd);
                card.addEventListener('dragover', handleDragOver);
                card.addEventListener('drop', handleDrop);
                card.addEventListener('dragleave', handleDragLeave);

                sitesGrid.appendChild(card);
            });

            // Add "+" card
            const addCard = document.createElement('div');
            addCard.className = 'site-card add-card';
            addCard.innerHTML = '+';
            addCard.onclick = openAddModal;
            sitesGrid.appendChild(addCard);
        }

        function handleDragStart(e) {
            draggedElement = this;
            draggedIndex = parseInt(this.dataset.index);
            this.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        }

        function handleDragEnd(e) {
            this.classList.remove('dragging');
            document.querySelectorAll('.site-card').forEach(card => {
                card.classList.remove('drag-over');
            });
        }

        function handleDragOver(e) {
            if (e.preventDefault) {
                e.preventDefault();
            }
            if (this.classList.contains('add-card')) return false;
            
            e.dataTransfer.dropEffect = 'move';
            this.classList.add('drag-over');
            return false;
        }

        function handleDragLeave(e) {
            this.classList.remove('drag-over');
        }

        function handleDrop(e) {
            if (e.stopPropagation) {
                e.stopPropagation();
            }
            if (this.classList.contains('add-card')) return false;

            const dropIndex = parseInt(this.dataset.index);
            
            if (draggedIndex !== dropIndex) {
                const draggedSite = sites[draggedIndex];
                sites.splice(draggedIndex, 1);
                sites.splice(dropIndex, 0, draggedSite);
                saveSites();
                renderSites();
            }

            return false;
        }

        function editSite(event, index) {
            event.preventDefault();
            event.stopPropagation();
            
            editingIndex = index;
            const site = sites[index];
            
            // Update modal title and button
            modalTitle.textContent = 'Edit Website';
            submitBtn.textContent = 'Update';
            
            // Pre-fill form
            document.getElementById('siteName').value = site.name;
            document.getElementById('siteUrl').value = site.url;
            currentIconType = site.iconType || 'favicon';
            
            if (site.iconType === 'emoji' && site.icon) {
                document.getElementById('siteIcon').value = site.icon;
            }
            
            updateIconTypeUI();
            siteModal.classList.add('active');
            document.getElementById('siteName').focus();
        }

        function deleteSite(event, index) {
            event.preventDefault();
            event.stopPropagation();
            if (confirm('Remove this website?')) {
                sites.splice(index, 1);
                saveSites();
                renderSites();
            }
        }

        function openAddModal() {
            editingIndex = null;
            modalTitle.textContent = 'Add New Website';
            submitBtn.textContent = 'Add';
            siteModal.classList.add('active');
            document.getElementById('siteName').focus();
        }

        function closeModal() {
            siteModal.classList.remove('active');
            siteForm.reset();
            editingIndex = null;
            currentIconType = 'favicon';
            updateIconTypeUI();
        }

        function applyTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            themeToggle.textContent = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            currentTheme = theme;
            localStorage.setItem('theme', theme);
        }

        function toggleTheme() {
            applyTheme(currentTheme === 'dark' ? 'light' : 'dark');
        }

        function updateIconTypeUI() {
            iconTypeBtns.forEach(btn => {
                btn.classList.toggle('active', btn.dataset.type === currentIconType);
            });
            emojiGroup.style.display = currentIconType === 'emoji' ? 'block' : 'none';
        }

        // Event Listeners
        siteForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const siteData = {
                name: document.getElementById('siteName').value,
                url: document.getElementById('siteUrl').value,
                iconType: currentIconType
            };
            
            if (currentIconType === 'emoji') {
                siteData.icon = document.getElementById('siteIcon').value;
            }
            
            if (editingIndex !== null) {
                // Update existing site
                sites[editingIndex] = siteData;
            } else {
                // Add new site
                sites.push(siteData);
            }
            
            saveSites();
            renderSites();
            closeModal();
        });

        iconTypeBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                currentIconType = btn.dataset.type;
                updateIconTypeUI();
            });
        });

        themeToggle.addEventListener('click', toggleTheme);
        cancelBtn.addEventListener('click', closeModal);
        shortcutsBtn.addEventListener('click', () => shortcutsModal.classList.add('active'));
        closeShortcutsBtn.addEventListener('click', () => shortcutsModal.classList.remove('active'));

        // Close modals on outside click
        [siteModal, shortcutsModal].forEach(modal => {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.remove('active');
                    if (modal === siteModal) closeModal();
                }
            });
        });

        // Keyboard Shortcuts
        document.addEventListener('keydown', (e) => {
            // Ignore if typing in input
            if (e.target.tagName === 'INPUT') {
                if (e.key === 'Escape') {
                    e.target.blur();
                    closeModal();
                    shortcutsModal.classList.remove('active');
                }
                return;
            }

            switch(e.key.toLowerCase()) {
                case 'a':
                    e.preventDefault();
                    openAddModal();
                    break;
                case 'd':
                    e.preventDefault();
                    toggleTheme();
                    break;
                case 'escape':
                    closeModal();
                    shortcutsModal.classList.remove('active');
                    break;
                case '?':
                    e.preventDefault();
                    shortcutsModal.classList.add('active');
                    break;
                case '1':
                case '2':
                case '3':
                case '4':
                case '5':
                case '6':
                case '7':
                case '8':
                case '9':
                    const index = parseInt(e.key) - 1;
                    if (sites[index]) {
                        window.location.href = sites[index].url;
                    }
                    break;
            }
        });

        // Make functions globally accessible for inline onclick
        window.editSite = editSite;
        window.deleteSite = deleteSite;
    </script>
</body>
</html>